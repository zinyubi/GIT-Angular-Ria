/* ===== Base / Tokens ===== */
:host {
  --bg: #0b0f18;
  --panel: #0f1623;
  --panel2: #0c121c;
  --nav1: #0a1e3a;
  --nav2: #0b2143;

  --border: rgba(255, 255, 255, .08);
  --border2: rgba(255, 255, 255, .14);

  --text: #e9f1ff;
  --muted: #a6b4cf;

  --accent: #3b82f6;
  --accentSoft: rgba(59, 130, 246, .18);

  --r-xl: 14px;
  --r-lg: 12px;
  --r-md: 10px;

  --sidebarW: 300px;
  --sidebarWIcon: 72px;
  --toolsW: 380px;
  --gap: 12px;

  color: var(--text);
  background: var(--bg);
}

/* sensible defaults inside this component */
:host * { box-sizing: border-box; }

/* ===== Header ===== */
.planning-header {
  position: sticky;
  top: 0;
  z-index: 5;
  background: var(--panel2);
  border-bottom: 1px solid var(--border);
  padding: 14px 18px;
}
.planning-title { margin: 0; font-weight: 600; }

/* ===== 3-column Grid ===== */
.planning-workspace{
  display:grid;
  grid-template-columns:var(--sidebarW) minmax(320px,var(--toolsW)) minmax(0,1fr);
  gap:var(--gap);
  height:calc(100% - 64px);
  padding:10px var(--gap) var(--gap);
  overflow:hidden;
}
.planning-workspace.is-collapsed{
  grid-template-columns:var(--sidebarWIcon) var(--toolsW) minmax(0,1fr);
}

/* ===== Sidebar (blue) ===== */
.rail-sidebar{
  position:relative;
  display:flex; flex-direction:column; gap:12px;
  background:linear-gradient(180deg,var(--nav1),var(--nav2));
  border:1px solid var(--border);
  border-radius:18px;
  padding:10px;
  overflow:hidden;
}

/* Collapsed rail (4 icons) */
.rail-collapsed{ display:grid; gap:10px; justify-items:center; }
.rail-btn{
  position:relative;
  width:44px; height:44px; display:grid; place-items:center;
  border:1px solid var(--border); border-radius:14px;
  background:rgba(255,255,255,.10);
  color:#fff; cursor:pointer;
  transition:background .15s ease, border-color .15s ease, transform .05s ease;
  outline: none;
}
.rail-btn:hover{ background:rgba(255,255,255,.16); border-color:var(--border2); }
.rail-btn:active{ transform:translateY(1px); }
.rail-btn.disabled,[disabled]{ opacity:.45; cursor:not-allowed; }

/* Tooltip (pill + arrow) */
.rail-btn[data-tip]:hover::after,
.rail-btn[data-tip]:hover::before{
  position:absolute; left:60px; top:50%; transform:translateY(-50%); pointer-events:none;
}
.rail-btn[data-tip]:hover::after{
  content:attr(data-tip);
  background:#0f172a; color:#fff;
  border:1px solid var(--border);
  padding:6px 10px; border-radius:10px; white-space:nowrap;
  box-shadow:0 8px 24px rgba(0,0,0,.35);
}
.rail-btn[data-tip]:hover::before{
  content:''; border:6px solid transparent; border-right-color:#0f172a; margin-left:-12px;
}

/* Expanded rail (collapse button only) */
.rail-expanded{ display:grid; justify-items:center; }
.rail-content{ display:flex; flex-direction:column; gap:12px; overflow:auto; }

/* Expanded header */
.rail-header{ display:flex; align-items:center; justify-content:space-between; padding:0 6px; }
.rail-header h3{ margin:0; font-size:15px; font-weight:700; }
.chip{
  background:rgba(255,255,255,.10);
  border:1px solid var(--border);
  color:#fff; padding:6px 10px; border-radius:10px; cursor:pointer;
}

/* Scenario list */
.scenario-list{
  list-style:none; margin:0; padding:6px;
  background:rgba(255,255,255,.05);
  border:1px solid var(--border);
  border-radius:var(--r-xl);
  max-height:260px; overflow:auto;
}
.scenario-row{
  display:grid; grid-template-columns:30px 1fr auto;
  align-items:center; gap:10px; padding:8px 10px;
  border-radius:10px; transition:background .12s ease;
}
.scenario-row + .scenario-row{ margin-top:6px; }
.scenario-row:hover{ background:rgba(255,255,255,.12); }
.scenario-row.active{
  background:linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.08));
}
.row-icon{
  width:30px; height:30px; display:grid; place-items:center;
  border-radius:9px; border:1px solid var(--border2); background:rgba(255,255,255,.12);
}
.row-name{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.row-del{
  width:34px; height:34px; display:grid; place-items:center;
  border-radius:10px; border:1px solid var(--border);
  background:rgba(255,255,255,.08); color:#ffd7dc;
}
.row-del:hover{ background:rgba(255,255,255,.14); }

/* Scenario detail card */
.detail-card{
  background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
  border:1px solid var(--border2);
  border-radius:var(--r-xl);
  padding:12px; color:#eef4ff;
}
.hint{ color:var(--muted); }

/* ===== Tools column ===== */
.tools{
  display:flex; flex-direction:column; gap:var(--gap);
  overflow:auto; padding:6px 0; min-width:0; /* prevent horizontal scroll */
}
.card{
  position:relative;
  background:var(--panel); border:1px solid var(--border);
  border-radius:var(--r-xl);
  box-shadow:0 10px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);
}

/* Accordion */
.accordion .acc-summary{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 14px; margin:10px 12px 0;
  background:rgba(255,255,255,.04);
  border:1px solid var(--border);
  border-radius:12px;
  color:var(--text); font-weight:600; cursor:pointer;
  outline: none;
}
.accordion .acc-summary:focus-visible{
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accentSoft);
}
.accordion .acc-content{
  display:none; padding:14px 16px 16px; margin:8px 12px 12px;
  background:transparent; border-radius:12px;
}
.accordion .acc-content.open{
  display:block;
  max-height:calc(100vh - 240px);
  overflow-y:auto; overflow-x:hidden;
}
.chev{ transition:transform .2s ease; }
.chev.open{ transform:rotate(180deg); }

/* Forms (robust grid; no overflow) */
.form{ display:grid; gap:12px; align-content:start; min-width:0; }
.grid2{ grid-template-columns:repeat(2, minmax(0,1fr)); gap:12px; }
.grid3{ grid-template-columns:repeat(3, minmax(0,1fr)); gap:12px; }

.form label{ display:grid; gap:6px; min-width:0; font-size:13px; color:var(--muted); }

.form input,
.form textarea,
.form select{
  width:100%; min-width:0;
  background:#0b1220; color:var(--text);
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px 12px;
  outline:none;
}
.form input:focus,
.form textarea:focus,
.form select:focus{
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accentSoft);
}

.form-actions{ display:flex; gap:8px; justify-content:flex-end; }
.form-actions.push{ grid-column:1 / -1; }

/* Lists inside cards */
.list-block{ margin-top:8px; }
.plain{ list-style:none; margin:0; padding:0; }
.row{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:8px 0; border-top:1px solid var(--border);
}
.row:first-child{ border-top:none; }
.subtle{ margin:0 0 6px; font-size:14px; font-weight:600; }

/* Buttons */
.btn{
  border:none; border-radius:12px; padding:10px 14px; cursor:pointer;
  outline: none;
}
.btn:focus-visible{ box-shadow:0 0 0 3px var(--accentSoft); }

.btn-primary{ background:#186cff; color:#fff; }
.btn-success{ background:#1fa465; color:#fff; }
.btn-secondary{ background:#3f4a58; color:#fff; }
.btn-light{ background:#fff; color:#0b2143; border-radius:10px; padding:8px 12px; }
.btn-link{ background:transparent; color:var(--accent); padding:0; }

/* Misc text */
.muted{ color:var(--muted); }
.divider{ height:1px; background:var(--border); grid-column:1 / -1; }
.error{ color:#ff8c99; font-size:12px; }

/* ===== Map ===== */
.map-wrap{
  border:1px solid var(--border);
  border-radius:var(--r-xl);
  overflow:hidden;
  background:var(--panel2);
  min-width:0; /* avoid overflow */
}
.map{ width:100%; height:100%; min-height:360px; }

/* ===== Scrollbar (optional, subtle) ===== */
:host ::-webkit-scrollbar{ height:8px; width:8px; }
:host ::-webkit-scrollbar-thumb{ background:rgba(255,255,255,.18); border-radius:8px; }
:host ::-webkit-scrollbar-track{ background:transparent; }

/* ===== Responsive tweaks ===== */
@media (max-width: 1280px){
  .grid2{ grid-template-columns:1fr; }
  .grid3{ grid-template-columns:repeat(2, minmax(0,1fr)); }
}
