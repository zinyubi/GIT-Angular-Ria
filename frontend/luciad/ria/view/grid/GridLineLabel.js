import{HTML5TextUtil}from"../style/HTML5TextUtil.js";import{LABEL_CONFLICT_PADDING}from"../style/LabelConflictChecker.js";import{GridLineLabelLocationUtil}from"./GridLineLabelLocationUtil.js";import{LabelLocation}from"./LabelLocation.js";import{LabelPosition}from"./LabelPosition.js";const type="GridLineLabel";export class GridLineLabel{constructor(t,i,e,o){this._coordinates=t;this._text=i;this._textStyle=e;this._labelBothSides=LabelPosition.ALL_SIDES===o;this._bounds=HTML5TextUtil.calculateBounds(this._text,this._textStyle,true,true);this._param={labelWidth:this._bounds[2]-this._bounds[0],labelHeight:this._bounds[3]-this._bounds[1],lines:this._coordinates};this._possibleLocations=[];this._realLocations=[]}get coordinates(){return this._coordinates}updateRotatedBox(t){t.configure(t.getX(),t.getY(),t.getWidth(),t.getHeight(),t.getRotation(),t.getAnchorX(),t.getAnchorY(),LABEL_CONFLICT_PADDING)}filterPossiblePositions(t){this._realLocations.length=0;let i=0;const e=this._possibleLocations.length;let o,s;while(i<e){o=this._possibleLocations[i];this.updateRotatedBox(o);s=t.isLabelAllowed(o);if(s){t.addPosition(o);this._realLocations.push(this._possibleLocations[i])}i+=1}}collectLabelLocationsSFCT(t){this._possibleLocations.length=0;t.lastToFirst=false;const i=new LabelLocation;let e=GridLineLabelLocationUtil.findLabelLocationSFCT(t,i);if(e)this._possibleLocations.push(i);if(this._labelBothSides){t.lastToFirst=true;const i=new LabelLocation;e=GridLineLabelLocationUtil.findLabelLocationSFCT(t,i);if(e)this._possibleLocations.push(i)}}paint(t,i,e){this._param.mapToViewTransformation=i.mapToViewTransformation;this._param.viewWidth=i.getViewWidth();this._param.viewHeight=i.getViewHeight();this._param.leftOffset=i.getLeftBorderSize();this.collectLabelLocationsSFCT(this._param);this.filterPossiblePositions(e);let o,s;for(o=0;o<this._realLocations.length;o+=1){s=this._realLocations[o];HTML5TextUtil.drawTextAnchoredTopLeft(t,this._text,s.getX(),s.getY(),s.getAngleInDegrees(),this._textStyle,1)}}get type(){return type}}