import{LabelLocation}from"../LabelLocation.js";import{flipLayerClipY,INVALID_LAYER_CLIP,isOutsideLayerClip,scaleLayerClip}from"../../LayerStyle.js";export class AbstractDrawGridLabelHtmlContents extends LabelLocation{constructor(e,t,i,l){super();this.html=e;this._labelWidth=Math.ceil(t[2]-t[0]);this._labelHeight=Math.ceil(t[3]-t[1]);this.group=i;this._photonView=l;this.zOrder=null;this._handle=null;this._clip=INVALID_LAYER_CLIP}placeHtml(e,t,i,l){if("number"===typeof l)this.zOrder=l;const s={...this._clip};flipLayerClipY(s,t.viewSize[1]);scaleLayerClip(s,t.displayScale);if(!this.findLabelLocationSFCT(t,this._labelWidth,this._labelHeight,this._photonView,s,this)){this._handle=null;return false}if(!i.isLabelAllowed(this)){this._handle=null;return false}if(isOutsideLayerClip(this,t.viewSize[1],this._clip,1.5)){this._handle=null;return false}this._toScreen(e);if(t.wrapAroundWorld)this._handle=null;return true}_toScreen(e){const t=this.getX();const i=this.getY();const l=this.getAngleInDegrees();if(!this._handle)this._handle=e.placeHtmlInDom(this,this.html,t,i,l,this._labelWidth,this._labelHeight,0,0,void 0,this.zOrder);else e.modifyHtmlPositionInDom(this._handle,t,i,l,this._labelWidth,this._labelHeight,0,0,this.zOrder)}requestToDrawLabel(e){this._clip=e??INVALID_LAYER_CLIP;if(this.group)this.group.addLabel(this)}get handle(){return this._handle}set handle(e){this._handle=e}canBeReused(){return false}findLabelDrawCommand(e,t){return null}isReady(){return true}reuseStateFrom(e){}setPickInfoContext(e,t){}}