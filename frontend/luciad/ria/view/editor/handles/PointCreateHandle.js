import{REQUEST_FINISH}from"../../controller/HandleEventResult.js";import{GestureEventType}from"../../input/GestureEventType.js";import{PointDragHandle}from"./PointDragHandle.js";import*as SnapUtil from"../snapping/SnapUtil.js";import{EditMoveConstraint}from"./EditMoveConstraint.js";function isSingleTap(t){return GestureEventType.SINGLE_CLICK_CONFIRMED===t.type}export class PointCreateHandle extends PointDragHandle{_pointCreated=false;_editShapeListener=null;constructor(t,e){super((()=>t),(t=>{e(t)}),{handleIconStyle:null})}getCursor(t,e){return"crosshair"}onGestureEvent(t,e){const n=this.moveConstraint===EditMoveConstraint.HORIZONTAL||this.moveConstraint===EditMoveConstraint.XY;this.snapPoint=SnapUtil.findClosestPoint(t,this.getPoint(),e.shape,e.map,n);return super.onGestureEvent(t,e)}activate(t,e){this._pointCreated=false;this._editShapeListener=this.on("EditShape",(()=>{this._pointCreated=true}));return super.activate(t,e)}deactivate(t,e){this._editShapeListener?.remove();this._editShapeListener=null;return super.deactivate(t,e)|REQUEST_FINISH}shouldActivate(t,e){return isSingleTap(t)}shouldProcess(t){return isSingleTap(t)}shouldDeactivate(t){return this._pointCreated&&isSingleTap(t)}shouldPaintFeature(t){return this._pointCreated}}