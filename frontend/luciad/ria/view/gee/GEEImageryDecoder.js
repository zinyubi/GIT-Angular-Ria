import{mimeType}from"../../util/mimeType.js";import*as ProtocolBuffer from"../../util/protocolbuffer/ProtocolBuffer.js";import{decode}from"./GEEPacketDecoder.js";const EARTH_IMAGERY_PACKET_DECODER_JSON={nested:{keyhole:{options:{java_package:"com.google.keyhole.common.proto"},nested:{EarthImageryPacket:{fields:{imageType:{type:"Codec",id:1,options:{default:"JPEG"}},imageData:{type:"bytes",id:2},alphaType:{type:"SeparateAlphaType",id:3,options:{default:"NONE"}},imageAlpha:{type:"bytes",id:4},copyrightIds:{rule:"repeated",type:"uint32",id:5,options:{packed:false}}},nested:{Codec:{values:{JPEG:0,JPEG2000:1,DXT1:2,DXT5:3,PNG_RGBA:4}},SeparateAlphaType:{values:{NONE:0,PNG:1,JPEG_ALPHA:2,RLE_1_BIT:3}}}}}}}};var Codec=function(e){e[e["JPEG"]=0]="JPEG";e[e["JPEG2000"]=1]="JPEG2000";e[e["DXT1"]=2]="DXT1";e[e["DXT5"]=3]="DXT5";e[e["PNG_RGBA"]=4]="PNG_RGBA";return e}(Codec||{});export let SeparateAlphaType=function(e){e[e["NONE"]=0]="NONE";e[e["PNG"]=1]="PNG";e[e["JPEG_ALPHA"]=2]="JPEG_ALPHA";e[e["RLE_1_BIT"]=3]="RLE_1_BIT";return e}({});const EarthImageryPacketDecoder=ProtocolBuffer.Root.fromJSON(EARTH_IMAGERY_PACKET_DECODER_JSON).lookupType("keyhole.EarthImageryPacket");function getMimeType(e){if(e===Codec.JPEG)return mimeType.jpeg;if(e===Codec.PNG_RGBA)return mimeType.png;if(e===Codec.JPEG2000)return mimeType.jp2;throw new Error("Unsupported texture codec (DXT1 or DXT5)")}export function decodeImagery(e){const o=decode(e);if(EarthImageryPacketDecoder){const e=EarthImageryPacketDecoder.decode(new Uint8Array(o));return{data:e.imageData,mimeType:getMimeType(e.imageType)}}return null}