import{getUnitOfMeasureBySymbol}from"./UnitOfMeasureRegistry.js";import{ParseError}from"../error/ParseError.js";const MACH_TO_MPS=340.3;const KNOTS_TO_MPS=1852/3600;export function parseSpeed(r,e){let o=/^(\d+\.?\d*)(.*?)$/.exec(r.toLocaleLowerCase().replace(/\s/g,""));if(!o)throw new ParseError(`Cannot parse speed from ${r}`);const t=Number.parseFloat(o[1]);const n=o[2]||e;if("mach"===n)return t*MACH_TO_MPS;if("kn"===n)return t*KNOTS_TO_MPS;o=/^(.+)\/(.+)$/.exec(n);if(!o)throw new ParseError(`Cannot parse speed from ${r}: unknown unit ${n}`);try{const r=getUnitOfMeasureBySymbol(o[1]);const e=getUnitOfMeasureBySymbol(o[2]);return t*r.convertToStandard(1)/e.convertToStandard(1)}catch(e){const o=e instanceof Error?e.message:""+e;throw new ParseError(`Cannot parse speed from ${r}: ${o}`)}}