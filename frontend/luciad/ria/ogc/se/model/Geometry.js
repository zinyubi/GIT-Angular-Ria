import{SEElementType}from"./SEElementType.js";import{SENamedElement}from"./SENamedElement.js";import{createEvaluationFunction,PRE_DEFINED_FUNCTION_EVALUATORS}from"../../FunctionEvaluatorUtil.js";import{isDefined}from"../../../util/Lang.js";import{ProgrammingError}from"../../../error/ProgrammingError.js";import{OGCStringFilterBuilderVisitor}from"../../filter/OGCStringFilterBuilderVisitor.js";export class Geometry extends SENamedElement{_content=null;_evaluateNewShape=null;constructor(e){super(SEElementType.GEOMETRY);this._functionEvaluators=isDefined(e)?Object.assign({},PRE_DEFINED_FUNCTION_EVALUATORS,e):PRE_DEFINED_FUNCTION_EVALUATORS}get content(){return this._content}set content(e){this._content=e;this.createShapeEvaluationFunction()}getShapeForStyling(e,t){if(!this._evaluateNewShape)this.createShapeEvaluationFunction();if(!this._evaluateNewShape)throw new ProgrammingError("We need an evaluateNewShape method, it should get created lazily.");else{const n=this._evaluateNewShape(this._functionEvaluators,e,t);return null===n?t:n}}createShapeEvaluationFunction(){const e=this.createShapeExpression();this._evaluateNewShape=createEvaluationFunction(e)}createShapeExpression(){let e="";if(null!==this.content){const t=new OGCStringFilterBuilderVisitor({functionEvaluators:this._functionEvaluators,expectedFunctionOutput:"Shape | null"});t.reset();this.content.accept(t);e+=t.expression}return"return "+e+";"}}