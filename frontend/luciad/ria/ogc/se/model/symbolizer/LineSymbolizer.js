import{SEElementType}from"../SEElementType.js";import{Stroke}from"../Stroke.js";import{BodySymbolizer}from"./BodySymbolizer.js";import{Log}from"../../../../util/Log.js";import{PIXEL_UOM}from"../../../../uom/UnitOfMeasureUtil.js";import{SupportedVendorOptions}from"../VendorOption.js";export class LineSymbolizer extends BodySymbolizer{static VALID_CHILDREN=(new Array).concat(BodySymbolizer.VALID_CHILDREN,["Stroke","PerpendicularOffset"]);static VALID_VENDOR_OPTIONS=[SupportedVendorOptions.VENDOR_OPTION_INCLUSION];_stroke=null;_perpendicularOffset=null;constructor(e){super(e||SEElementType.LINE_SYMBOLIZER)}isReady(){return null===this._stroke?Promise.resolve():this._stroke.isReady()}get validVendorOptions(){return LineSymbolizer.VALID_VENDOR_OPTIONS}get stroke(){return this._stroke}set stroke(e){if(e)e.eventedSupport=this.eventedSupport;this._stroke=e}get perpendicularOffset(){return this._perpendicularOffset}set perpendicularOffset(e){if(e)e.eventedSupport=this.eventedSupport;this._perpendicularOffset=e;this._perpendicularOffset?.createNumberEvaluationFunction()}createStrokeStyles(e,t,r,o=[0,0]){if(!this._stroke)return[];else{let s=0;if(r&&this._perpendicularOffset)s=this._perpendicularOffset.evaluateContentAsNumber(e,t);if(this._stroke.canBeStyledSimple()&&0===s&&0===o[0]&&0===o[1]&&this.uom===PIXEL_UOM)return[this._stroke.createSimpleStrokeStyle(e,t,this.uom)];else try{return this._stroke.createStrokeStyles(e,t,this.uom,s,1,o)}catch(r){Log.error("Symbology Encoding Painter - strokeStyle for Line/PolygonSymbolizer: "+(r instanceof Error?r.message:r));return(new Stroke).createStrokeStyles(e,t,this.uom,0,1,o)}}}createStrokeFillStyle(e,t){if(!this._stroke)return;else return this._stroke.createStrokeFillStyle(e,t,this.uom,0,1)}isWorldSized(){return this.uom!==PIXEL_UOM}getBufferWidth(e,t,r){if(!this._stroke)return 1;else{const o=this._stroke.getBufferWidth(e,t,this.uom,1);return r.toMapUnits(o,this.uom,true)}}getPerpendicularOffset(e,t,r){if(!this._perpendicularOffset)return 0;else{const o=this._perpendicularOffset.evaluateContentAsNumber(e,t);return r.toMapUnits(o,this.uom,true)}}}