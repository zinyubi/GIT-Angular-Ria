import{XMLSchema}from"../../util/XMLSchema.js";import{RasterDataType}from"../tileset/RasterDataType.js";import{RasterSamplingMode}from"../tileset/RasterSamplingMode.js";import{freeze}from"./common/CapabilitiesParserUtil.js";import{LTSQuerySchema}from"./LTSQuerySchema.js";import{LTSCapabilitiesCoverage}from"./LTSCapabilitiesCoverage.js";import{Lang}from"../../util/Lang.js";export class LTSQueryParser{constructor(e){const a=undefined;const t=new XMLSchema(LTSQuerySchema).parse(e);this._rawMetadata=t["Metadata"]}parseCoverages(){const e=this._rawMetadata.RasterCoverageMetadata.map(this._parseRasterCoverage,this);return freeze(e)}_parseRasterCoverage(e){const a=e.BoundingBox;return new LTSCapabilitiesCoverage({id:e.id,type:this._parseRasterCoverageType(e),name:e.Name,abstract:e.Abstract,level0Rows:e.Level0RowCount,level0Columns:e.Level0ColumnCount,tileWidth:e.TileWidth,tileHeight:e.TileHeight,samplingMode:this._parseRasterSamplingMode(e.SamplingMode),referenceName:e.GeoReference,bounds:{x:a.X,y:a.Y,width:a.Width,height:a.Height}})}_parseRasterCoverageType(e){const a=undefined;switch(e.Type.toUpperCase()){case"ELEVATION":return RasterDataType.ELEVATION;case"IMAGE":return RasterDataType.IMAGE;case"RASTER":if(Lang.isDefined(e.MeasurementBand)&&(Lang.isDefined(e.MeasurementBand.UnitOfMeasure)&&"terrain height"===e.MeasurementBand.UnitOfMeasure.measureTypeCode||"SIGNED_SHORT"===e.MeasurementBand.DataType2&&16===e.MeasurementBand.SignificantBits))return RasterDataType.ELEVATION;else return null;default:return null}}_parseRasterSamplingMode(e){switch(e=e.toUpperCase()){case"AREA":return RasterSamplingMode.AREA;case"POINT":return RasterSamplingMode.POINT;default:return null}}}