import{WMSCapabilitiesUtil}from"./WMSCapabilitiesUtil.js";import{WMSCapabilitiesParserV130}from"./WMSCapabilitiesParserV130.js";import{WMSCapabilitiesParserV111}from"./WMSCapabilitiesParserV111.js";import{WMSVersion}from"../../ogc/WMSVersion.js";const SUPPORTED_VERSIONS=[WMSVersion.V130,WMSVersion.V111];function createParser(e,i){switch(e){case"1.3.0":return new WMSCapabilitiesParserV130(i);case"1.1.1":return new WMSCapabilitiesParserV111(i);default:throw new Error(`Can not parse unsupported WMS version: ${e}`)}}export class WMSCapabilities{constructor(e,i){this._capabilitiesXML=i;const r=createParser(e,i);this._version=r.version;this._parser=r;this._service=r.parseServiceMetadata();this._updateSequence=r.parseUpdateSequence();this._layers=r.parseLayers();this._operations=r.parseOperations();this._exceptionFormats=r.parseExceptionFormats();this._userDefinedSymbolization=r.parseUserDefinedSymbolization()}static async fromURL(e,i){const r={credentials:(i=i||{}).credentials,requestHeaders:i.requestHeaders,requestParameters:i.requestParameters};const s=WMSCapabilitiesUtil.createVersionNegotiator(e,SUPPORTED_VERSIONS,i.allowedVersions,r);const t=await s.negotiateVersion();return new WMSCapabilities(t.version,t.response)}static fromXML(e){const i=WMSCapabilitiesUtil.parseVersion(e);const r=new WMSCapabilities(i,e);return Promise.resolve(r)}getRawCapabilities(){return this._capabilitiesXML}get version(){return this._version}get service(){return this._service}get updateSequence(){return this._updateSequence}get layers(){return this._layers}get operations(){return this._operations}get exceptionFormats(){return this._exceptionFormats}get userDefinedSymbolization(){return this._userDefinedSymbolization}}