import{asPromise}from"./asPromise.js";export function fetch(e,r,t){if("function"===typeof r){t=r;r={}}else if(!r)r={};if(!t)return asPromise(fetch,null,e,r);return xhr(e,r,t)}function xhr(e,r,t){const n=new XMLHttpRequest;n.onreadystatechange=()=>{if(4!==n.readyState)return;if(0!==n.status&&200!==n.status)return t(Error("status "+n.status));if(r.binary){let e=n.response;if(!e){e=[];for(let r=0;r<n.responseText.length;++r)e.push(255&n.responseText.charCodeAt(r))}return t(null,"undefined"!==typeof Uint8Array?new Uint8Array(e):e)}return t(null,n.responseText)};if(r.binary){if("overrideMimeType"in n)n.overrideMimeType("text/plain; charset=x-user-defined");n.responseType="arraybuffer"}n.open("GET",e);n.send()}