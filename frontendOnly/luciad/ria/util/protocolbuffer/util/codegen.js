export function codegen(n,e){return"string"===typeof n?codegenInternal([],n):codegenInternal(n??[],e)}function codegenInternal(n,e=""){const t=[];function r(n,...e){if("string"!==typeof n){let e=o();if(isVerbose)console.log(`codegen: ${e}`);e=`return ${e}`;if(n){const t=Object.keys(n);const r=new Array(t.length+1);const o=new Array(t.length);let i=0;while(i<t.length){r[i]=t[i];o[i]=n[t[i++]]}r[i]=e;return Function.apply(null,r).apply(null,o)}return Function(e)()}let i=0;n=n.replace(/%([%dfijs])/g,((n,t)=>{const r=e[i++];switch(t){case"d":case"f":return String(Number(r));case"i":return String(Math.floor(r));case"j":return JSON.stringify(r);case"s":return String(r)}return"%"}));if(i!==e.length)throw Error("parameter count mismatch");t.push(n);return r}function o(r){return`function ${r||e}(${n.join(",")||""}){\n  ${t.join("\n  ")}\n}`}r.toString=o;return r}let isVerbose=false;export function setVerbose(n){isVerbose=n}