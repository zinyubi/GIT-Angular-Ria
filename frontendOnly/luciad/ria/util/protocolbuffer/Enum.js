import{ReflectionObject}from"./ReflectionObject.js";import{isReservedId,isReservedName}from"./util.js";import{isInteger,isString}from"./util/lang.js";export class Enum extends ReflectionObject{static className="Enum";constructor(e,s,t,i,r){super(e,t);this._PB_ENUM=true;if(s&&"object"!==typeof s)throw TypeError("values must be an object");this.valuesById={};this.values=Object.create(this.valuesById);this.comment=i??null;this.comments=r||{};this.reserved=void 0;if(s)for(let e=Object.keys(s),t=0;t<e.length;++t)if("number"===typeof s[e[t]])this.valuesById[this.values[e[t]]=s[e[t]]]=e[t]}static fromJSON(e,s){const t=new Enum(e,s.values,s.options,s.comment,s.comments);t.reserved=s.reserved;return t}toJSON(e){const s=e?.keepComments;const{options:t,values:i,reserved:r,comment:o,comments:n}=this;const m={values:i};if(void 0!==t)m.options=t;if(r?.length)m.reserved=r;if(s){if(o)m.comment=o;if(n)m.comments=n}return m}add(e,s,t){if(!isString(e))throw TypeError("name must be a string");if(!isInteger(s))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(s))throw Error("id "+s+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[s]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+s+" in "+this);this.values[e]=s}else this.valuesById[this.values[e]=s]=e;this.comments[e]=t||null;return this}remove(e){if(!isString(e))throw TypeError("name must be a string");const s=this.values[e];if(null==s)throw Error(`name '${e}' does not exist in ${this}`);delete this.valuesById[s];delete this.values[e];delete this.comments[e];return this}isReservedId(e){return isReservedId(this.reserved,e)}isReservedName(e){return isReservedName(this.reserved,e)}}