var Z_FIXED=4;var Z_BINARY=0;var Z_TEXT=1;var Z_UNKNOWN=2;function zero(e){var _=e.length;while(--_>=0)e[_]=0}var STORED_BLOCK=0;var STATIC_TREES=1;var DYN_TREES=2;var MIN_MATCH=3;var MAX_MATCH=258;var LENGTH_CODES=29;var LITERALS=256;var L_CODES=LITERALS+1+LENGTH_CODES;var D_CODES=30;var BL_CODES=19;var HEAP_SIZE=2*L_CODES+1;var MAX_BITS=15;var Buf_size=16;var MAX_BL_BITS=7;var END_BLOCK=256;var REP_3_6=16;var REPZ_3_10=17;var REPZ_11_138=18;var extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var DIST_CODE_LEN=512;var static_ltree=new Array(2*(L_CODES+2));zero(static_ltree);var static_dtree=new Array(2*D_CODES);zero(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero(_dist_code);var _length_code=new Array(MAX_MATCH-MIN_MATCH+1);zero(_length_code);var base_length=new Array(LENGTH_CODES);zero(base_length);var base_dist=new Array(D_CODES);zero(base_dist);function StaticTreeDesc(e,_,t,r,i){this.static_tree=e;this.extra_bits=_;this.extra_base=t;this.elems=r;this.max_length=i;this.has_stree=e&&e.length}var static_l_desc;var static_d_desc;var static_bl_desc;function TreeDesc(e,_){this.dyn_tree=e;this.max_code=0;this.stat_desc=_}function d_code(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]}function put_short(e,_){e.pending_buf[e.pending++]=255&_;e.pending_buf[e.pending++]=_>>>8&255}function send_bits(e,_,t){if(e.bi_valid>Buf_size-t){e.bi_buf|=_<<e.bi_valid&65535;put_short(e,e.bi_buf);e.bi_buf=_>>Buf_size-e.bi_valid;e.bi_valid+=t-Buf_size}else{e.bi_buf|=_<<e.bi_valid&65535;e.bi_valid+=t}}function send_code(e,_,t){send_bits(e,t[2*_],t[2*_+1])}function bi_reverse(e,_){var t=0;do{t|=1&e;e>>>=1;t<<=1}while(--_>0);return t>>>1}function bi_flush(e){if(16===e.bi_valid){put_short(e,e.bi_buf);e.bi_buf=0;e.bi_valid=0}else if(e.bi_valid>=8){e.pending_buf[e.pending++]=255&e.bi_buf;e.bi_buf>>=8;e.bi_valid-=8}}function gen_bitlen(e,_){var t=_.dyn_tree;var r=_.max_code;var i=_.stat_desc.static_tree;var a=_.stat_desc.has_stree;var s=_.stat_desc.extra_bits;var n=_.stat_desc.extra_base;var d=_.stat_desc.max_length;var l;var c,b;var o;var f;var v;var u=0;for(o=0;o<=MAX_BITS;o++)e.bl_count[o]=0;t[2*e.heap[e.heap_max]+1]=0;for(l=e.heap_max+1;l<HEAP_SIZE;l++){if((o=t[2*t[2*(c=e.heap[l])+1]+1]+1)>d){o=d;u++}t[2*c+1]=o;if(c>r)continue;e.bl_count[o]++;f=0;if(c>=n)f=s[c-n];v=t[2*c];e.opt_len+=v*(o+f);if(a)e.static_len+=v*(i[2*c+1]+f)}if(0===u)return;do{o=d-1;while(0===e.bl_count[o])o--;e.bl_count[o]--;e.bl_count[o+1]+=2;e.bl_count[d]--;u-=2}while(u>0);for(o=d;0!==o;o--){c=e.bl_count[o];while(0!==c){if((b=e.heap[--l])>r)continue;if(t[2*b+1]!==o){e.opt_len+=(o-t[2*b+1])*t[2*b];t[2*b+1]=o}c--}}}function gen_codes(e,_,t){var r=new Array(MAX_BITS+1);var i=0;var a;var s;for(a=1;a<=MAX_BITS;a++)r[a]=i=i+t[a-1]<<1;for(s=0;s<=_;s++){var n=e[2*s+1];if(0===n)continue;e[2*s]=bi_reverse(r[n]++,n)}}function tr_static_init(){var e;var _;var t;var r;var i;var a=new Array(MAX_BITS+1);t=0;for(r=0;r<LENGTH_CODES-1;r++){base_length[r]=t;for(e=0;e<1<<extra_lbits[r];e++)_length_code[t++]=r}_length_code[t-1]=r;i=0;for(r=0;r<16;r++){base_dist[r]=i;for(e=0;e<1<<extra_dbits[r];e++)_dist_code[i++]=r}i>>=7;for(;r<D_CODES;r++){base_dist[r]=i<<7;for(e=0;e<1<<extra_dbits[r]-7;e++)_dist_code[256+i++]=r}for(_=0;_<=MAX_BITS;_++)a[_]=0;e=0;while(e<=143){static_ltree[2*e+1]=8;e++;a[8]++}while(e<=255){static_ltree[2*e+1]=9;e++;a[9]++}while(e<=279){static_ltree[2*e+1]=7;e++;a[7]++}while(e<=287){static_ltree[2*e+1]=8;e++;a[8]++}gen_codes(static_ltree,L_CODES+1,a);for(e=0;e<D_CODES;e++){static_dtree[2*e+1]=5;static_dtree[2*e]=bi_reverse(e,5)}static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS);static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS);static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}function init_block(e){var _;for(_=0;_<L_CODES;_++)e.dyn_ltree[2*_]=0;for(_=0;_<D_CODES;_++)e.dyn_dtree[2*_]=0;for(_=0;_<BL_CODES;_++)e.bl_tree[2*_]=0;e.dyn_ltree[2*END_BLOCK]=1;e.opt_len=e.static_len=0;e.last_lit=e.matches=0}function bi_windup(e){if(e.bi_valid>8)put_short(e,e.bi_buf);else if(e.bi_valid>0)e.pending_buf[e.pending++]=e.bi_buf;e.bi_buf=0;e.bi_valid=0}function copy_block(e,_,t,r){bi_windup(e);if(r){put_short(e,t);put_short(e,~t)}utils.arraySet(e.pending_buf,e.window,_,t,e.pending);e.pending+=t}function smaller(e,_,t,r){var i=2*_;var a=2*t;return e[i]<e[a]||e[i]===e[a]&&r[_]<=r[t]}function pqdownheap(e,_,t){var r=e.heap[t];var i=t<<1;while(i<=e.heap_len){if(i<e.heap_len&&smaller(_,e.heap[i+1],e.heap[i],e.depth))i++;if(smaller(_,r,e.heap[i],e.depth))break;e.heap[t]=e.heap[i];t=i;i<<=1}e.heap[t]=r}function compress_block(e,_,t){var r;var i;var a=0;var s;var n;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1];i=e.pending_buf[e.l_buf+a];a++;if(0===r)send_code(e,i,_);else{send_code(e,(s=_length_code[i])+LITERALS+1,_);if(0!==(n=extra_lbits[s]))send_bits(e,i-=base_length[s],n);send_code(e,s=d_code(--r),t);if(0!==(n=extra_dbits[s]))send_bits(e,r-=base_dist[s],n)}}while(a<e.last_lit);send_code(e,END_BLOCK,_)}function build_tree(e,_){var t=_.dyn_tree;var r=_.stat_desc.static_tree;var i=_.stat_desc.has_stree;var a=_.stat_desc.elems;var s,n;var d=-1;var l;e.heap_len=0;e.heap_max=HEAP_SIZE;for(s=0;s<a;s++)if(0!==t[2*s]){e.heap[++e.heap_len]=d=s;e.depth[s]=0}else t[2*s+1]=0;while(e.heap_len<2){t[2*(l=e.heap[++e.heap_len]=d<2?++d:0)]=1;e.depth[l]=0;e.opt_len--;if(i)e.static_len-=r[2*l+1]}_.max_code=d;for(s=e.heap_len>>1;s>=1;s--)pqdownheap(e,t,s);l=a;do{s=e.heap[1];e.heap[1]=e.heap[e.heap_len--];pqdownheap(e,t,1);n=e.heap[1];e.heap[--e.heap_max]=s;e.heap[--e.heap_max]=n;t[2*l]=t[2*s]+t[2*n];e.depth[l]=(e.depth[s]>=e.depth[n]?e.depth[s]:e.depth[n])+1;t[2*s+1]=t[2*n+1]=l;e.heap[1]=l++;pqdownheap(e,t,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1];gen_bitlen(e,_);gen_codes(t,d,e.bl_count)}function scan_tree(e,_,t){var r;var i=-1;var a;var s=_[0*2+1];var n=0;var d=7;var l=4;if(0===s){d=138;l=3}_[2*(t+1)+1]=65535;for(r=0;r<=t;r++){a=s;s=_[2*(r+1)+1];if(++n<d&&a===s)continue;else if(n<l)e.bl_tree[2*a]+=n;else if(0!==a){if(a!==i)e.bl_tree[2*a]++;e.bl_tree[2*REP_3_6]++}else if(n<=10)e.bl_tree[2*REPZ_3_10]++;else e.bl_tree[2*REPZ_11_138]++;n=0;i=a;if(0===s){d=138;l=3}else if(a===s){d=6;l=3}else{d=7;l=4}}}function send_tree(e,_,t){var r;var i=-1;var a;var s=_[0*2+1];var n=0;var d=7;var l=4;if(0===s){d=138;l=3}for(r=0;r<=t;r++){a=s;s=_[2*(r+1)+1];if(++n<d&&a===s)continue;else if(n<l)do{send_code(e,a,e.bl_tree)}while(0!==--n);else if(0!==a){if(a!==i){send_code(e,a,e.bl_tree);n--}send_code(e,REP_3_6,e.bl_tree);send_bits(e,n-3,2)}else if(n<=10){send_code(e,REPZ_3_10,e.bl_tree);send_bits(e,n-3,3)}else{send_code(e,REPZ_11_138,e.bl_tree);send_bits(e,n-11,7)}n=0;i=a;if(0===s){d=138;l=3}else if(a===s){d=6;l=3}else{d=7;l=4}}}function build_bl_tree(e){var _;scan_tree(e,e.dyn_ltree,e.l_desc.max_code);scan_tree(e,e.dyn_dtree,e.d_desc.max_code);build_tree(e,e.bl_desc);for(_=BL_CODES-1;_>=3;_--)if(0!==e.bl_tree[2*bl_order[_]+1])break;e.opt_len+=3*(_+1)+5+5+4;return _}function send_all_trees(e,_,t,r){var i;send_bits(e,_-257,5);send_bits(e,t-1,5);send_bits(e,r-4,4);for(i=0;i<r;i++)send_bits(e,e.bl_tree[2*bl_order[i]+1],3);send_tree(e,e.dyn_ltree,_-1);send_tree(e,e.dyn_dtree,t-1)}function detect_data_type(e){var _=4093624447;var t;for(t=0;t<=31;t++,_>>>=1)if(1&_&&0!==e.dyn_ltree[2*t])return Z_BINARY;if(0!==e.dyn_ltree[9*2]||0!==e.dyn_ltree[10*2]||0!==e.dyn_ltree[13*2])return Z_TEXT;for(t=32;t<LITERALS;t++)if(0!==e.dyn_ltree[2*t])return Z_TEXT;return Z_BINARY}var static_init_done=false;function _tr_init(e){if(!static_init_done){tr_static_init();static_init_done=true}e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc);e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc);e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc);e.bi_buf=0;e.bi_valid=0;init_block(e)}function _tr_stored_block(e,_,t,r){send_bits(e,(STORED_BLOCK<<1)+(r?1:0),3);copy_block(e,_,t,true)}function _tr_align(e){send_bits(e,STATIC_TREES<<1,3);send_code(e,END_BLOCK,static_ltree);bi_flush(e)}function _tr_flush_block(e,_,t,r){var i,a;var s=0;if(e.level>0){if(e.strm.data_type===Z_UNKNOWN)e.strm.data_type=detect_data_type(e);build_tree(e,e.l_desc);build_tree(e,e.d_desc);s=build_bl_tree(e);i=e.opt_len+3+7>>>3;if((a=e.static_len+3+7>>>3)<=i)i=a}else i=a=t+5;if(t+4<=i&&-1!==_)_tr_stored_block(e,_,t,r);else if(e.strategy===Z_FIXED||a===i){send_bits(e,(STATIC_TREES<<1)+(r?1:0),3);compress_block(e,static_ltree,static_dtree)}else{send_bits(e,(DYN_TREES<<1)+(r?1:0),3);send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1);compress_block(e,e.dyn_ltree,e.dyn_dtree)}init_block(e);if(r)bi_windup(e)}function _tr_tally(e,_,t){e.pending_buf[e.d_buf+2*e.last_lit]=_>>>8&255;e.pending_buf[e.d_buf+2*e.last_lit+1]=255&_;e.pending_buf[e.l_buf+e.last_lit]=255&t;e.last_lit++;if(0===_)e.dyn_ltree[2*t]++;else{e.matches++;_--;e.dyn_ltree[2*(_length_code[t]+LITERALS+1)]++;e.dyn_dtree[2*d_code(_)]++}return e.last_lit===e.lit_bufsize-1}export var trees={_tr_init:_tr_init,_tr_stored_block:_tr_stored_block,_tr_flush_block:_tr_flush_block,_tr_tally:_tr_tally,_tr_align:_tr_align};