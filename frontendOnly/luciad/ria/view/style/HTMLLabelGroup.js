import{ConflictType,LabelConflictChecker}from"./LabelConflictChecker.js";export let LabelGroupName=function(e){e["GROUP_DEFAULT"]="DEFAULT";e["GROUP_NON_DECLUTTERED"]="NON_DECLUTTERED";e["GROUP_CONTROLLER"]="_CONTROLLER";return e}({});function sortDescending(e,t){if(e.selected!==t.selected)return e.selected?-1:1;if(e.priority!==t.priority)return e.priority<t.priority?-1:1;return e.index-t.index}function sortAscending(e,t){return-1*sortDescending(e,t)}const NON_DECLUTTERED_CONFLICT_CHECKER={resetViewWidthHeight:()=>null,clear:()=>null,addPosition:()=>null,isValidPosition:()=>ConflictType.NO_CONFLICT};export class HTMLLabelGroup{constructor(e,t){this._groupName=e;this._worldIndex=0;this._labelsToDrawPerWorld=new Map;if(t){this._conflictChecker=t;this._comparator=sortDescending}else if(this._groupName===LabelGroupName.GROUP_NON_DECLUTTERED){this._conflictChecker=NON_DECLUTTERED_CONFLICT_CHECKER;this._comparator=sortAscending}else{this._conflictChecker=new LabelConflictChecker;this._comparator=sortDescending}}clear(){if(this._labelsToDrawPerWorld.has(this._worldIndex))this._labelsToDrawPerWorld.delete(this._worldIndex)}setWorldIndex(e){this._worldIndex=e}addLabel(e){if(!this._labelsToDrawPerWorld.has(this._worldIndex))this._labelsToDrawPerWorld.set(this._worldIndex,[]);const t=undefined;this._labelsToDrawPerWorld.get(this._worldIndex).push(e)}drawLabelGroup(e,t,r,i,o,l){this._conflictChecker.resetViewWidthHeight(r,i,o,l);this._conflictChecker.clear();const s=this._labelsToDrawPerWorld.get(this._worldIndex)??[];s.sort(this._comparator);for(let r=0;r<s.length;r++){const i=s[r];const o=this._groupName===LabelGroupName.GROUP_NON_DECLUTTERED?r:null;const l=undefined;if(i.placeHtml(e,t,this._conflictChecker,o))this._conflictChecker.addPosition(i)}}}